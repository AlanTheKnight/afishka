{"version":3,"file":"Register.f44c2100.js","sources":["../../src/components/Register.vue"],"sourcesContent":["<template>\n  <div class=\"container rt-wp mt-4\">\n    <div class=\"row justify-content-sm-center\">\n      <div class=\"col col-md-9 col-lg-6\">\n        <div class=\"card my-3\">\n          <div class=\"card-body\" id=\"auth-form-app\">\n            <h2 class=\"card-title text-center\">Регистрация</h2>\n            <!-- <div class=\"d-flex flex-row align-items-center mb-3\">\n              <i class=\"bi bi-exclamation-circle-fill text-danger me-3\"></i>\n              <div>\n                Пожалуйста, внимательно проверьте предоставленные данные перед завершением\n                регистрации - для их последующего изменения потребуется время\n              </div>\n            </div> -->\n            <div class=\"mb-3\">\n              <form-input\n                name=\"username\"\n                label=\"Имя пользователя\"\n                v-model=\"data.username.value\"\n                :error=\"data.username.errorMessage\"\n                :isBound=\"isBound\"\n                :maxlength=\"100\"\n              ></form-input>\n            </div>\n            <div class=\"mb-3\">\n              <form-input\n                name=\"password1\"\n                label=\"Пароль\"\n                v-model=\"data.password1.value\"\n                :error=\"data.password1.errorMessage\"\n                :isBound=\"isBound\"\n                :maxlength=\"100\"\n                password\n              ></form-input>\n            </div>\n            <div class=\"mb-3\">\n              <form-input\n                name=\"password2\"\n                label=\"Повторите пароль\"\n                v-model=\"data.password2.value\"\n                :error=\"data.password2.errorMessage\"\n                :isBound=\"isBound\"\n                :maxlength=\"100\"\n                password\n              ></form-input>\n            </div>\n\n            <div class=\"text-center\">\n              <button\n                type=\"submit\"\n                class=\"btn btn-outline-primary\"\n                @click.prevent=\"register\"\n              >\n                Зарегистрироваться\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { FormBuilder, handleBackendError, validateForm } from \"@/utils/forms\";\nimport { reactive, ref } from \"vue\";\nimport { FormInput } from \"@/components\";\nimport { CreateUserData, createUser } from \"@/api/services/auth\";\nimport { useRouter } from \"vue-router\";\nimport { AxiosError } from \"axios\";\n\nconst router = useRouter();\n\nconst data = reactive<FormBuilder>({\n  username: {\n    value: \"\",\n    validators: [\"required\"],\n  },\n  password1: {\n    value: \"\",\n    validators: [\"password1\"],\n  },\n  password2: {\n    value: \"\",\n    validators: [],\n    checkers: {\n      password_match: {\n        check: (value: string, state?: FormBuilder) =>\n          Boolean(state && value === state.password1.value),\n        errorMessage: \"Пароли не совпадают\",\n      },\n    },\n  },\n});\nconst isBound = ref(false);\n\nconst register = () => {\n  const verdict = validateForm(data);\n  if (!isBound.value) isBound.value = true;\n  if (!verdict) return;\n\n  const newStudent: CreateUserData = {\n    username: data.username.value,\n    password: data.password1.value,\n  };\n\n  createUser(newStudent)\n    .then(() => {\n      router.push(\"/login\");\n    })\n    .catch((e: AxiosError) => {\n      handleBackendError(e, {\n        \"400\": {\n          username: () => {\n            data.username.errorMessage = \"Имя пользователя уже занято\";\n          },\n        },\n      });\n    });\n};\n</script>\n\n<style scoped>\n#school-not-in-list > a {\n  text-decoration: none;\n  color: var(--bs-text-muted);\n}\n</style>\n"],"names":["router","useRouter","data","reactive","value","state","isBound","ref","register","verdict","validateForm","newStudent","createUser","e","handleBackendError"],"mappings":"ioBAuEA,MAAMA,EAASC,IAETC,EAAOC,EAAsB,CACjC,SAAU,CACR,MAAO,GACP,WAAY,CAAC,UAAU,CACzB,EACA,UAAW,CACT,MAAO,GACP,WAAY,CAAC,WAAW,CAC1B,EACA,UAAW,CACT,MAAO,GACP,WAAY,CAAC,EACb,SAAU,CACR,eAAgB,CACd,MAAO,CAACC,EAAeC,IACrB,QAAQA,GAASD,IAAUC,EAAM,UAAU,KAAK,EAClD,aAAc,0GAChB,CACF,CACF,CAAA,CACD,EACKC,EAAUC,EAAI,EAAK,EAEnBC,EAAW,IAAM,CACf,MAAAC,EAAUC,EAAaR,CAAI,EAEjC,GADKI,EAAQ,QAAOA,EAAQ,MAAQ,IAChC,CAACG,EAAS,OAEd,MAAME,EAA6B,CACjC,SAAUT,EAAK,SAAS,MACxB,SAAUA,EAAK,UAAU,KAAA,EAGhBU,EAAAD,CAAU,EAClB,KAAK,IAAM,CACVX,EAAO,KAAK,QAAQ,CAAA,CACrB,EACA,MAAOa,GAAkB,CACxBC,EAAmBD,EAAG,CACpB,IAAO,CACL,SAAU,IAAM,CACdX,EAAK,SAAS,aAAe,qJAC/B,CACF,CAAA,CACD,CAAA,CACF,CAAA"}